<% content_for :head do %>
<title>tripbyme.ch</title>

<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
<link rel="stylesheet" type="text/css" href="/stylesheets/search.css">
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
<script type="text/javascript" src="/javascripts/4sq_search.js"></script>
<script type="text/javascript">
  var markers = new Array();
  
  $(initialize);
  
  function initialize() {
    
    var latlng = new google.maps.LatLng(<%= @lat %>, <%= @lng %>);
    var myOptions = {
      zoom: 16,
      center: latlng,
      mapTypeId: google.maps.MapTypeId.SATELLITE,
      mapTypeControl: true,
      streetViewControl: false,
    };
    var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
    
    // debug: do it only once, for testing.
    fsq_search(map.getCenter(), map);
    
    google.maps.event.addListener(map, 'bounds_changed', function() {
      //fsq_search(map.getCenter(), map);
    });
  }
</script>
<% end %>

<% content_for :body do %>
  <div id="results">
    <!-- <img style="position: absolute; bottom: 0; float: right;" src="/images/logo5.jpg"> -->
    
    <h2 id="result_count">0 results</h2>
    
    <div id="result_items">
    <ul>
    </ul>
    </div>
  </div>
  <div class="map" id="map_container"><div id="map_canvas"></div></div>
<% end %>
